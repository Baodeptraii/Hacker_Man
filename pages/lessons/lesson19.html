<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XML Bombs


    </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" />
    <link rel="stylesheet" href="../../assets/css/lessonstyle.css">
    <style>

    </style>
</head>

<body>

    <header class="bg-success text-white py-5 text-center">
        <div class="container text-center">
            <h1 class="display-4">XML Bombs


            </h1>
            <a href="../../index.html" class="btn btn-light btn-lg mt-3">Back to Home</a>
        </div>
    </header>

    <div class="container">
        <!-- Hiếm - Thỉnh thoảng - Thường xuyên -->
        <!-- Khó - Trung bình - Dễ -->
        <!-- Nhẹ - Trung bình - Nghiêm trọng -->

        <div class="row row-box">
            <div class="col-md-4">
                <div class="box">
                    <h3>Độ phổ biến</h3>
                    <p>Hiếm</p>
                    <div class="icons">
                        <i class="fa-solid fa-virus fa-2x"></i>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="box">
                    <h3>Khả năng khai thác</h3>
                    <p>Dễ</p>
                    <div class="icons">
                        <i class="fa-solid fa-wrench fa-2x"></i>
                        <i class="fa-solid fa-wrench fa-2x"></i>
                        <i class="fa-solid fa-wrench fa-2x"></i>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="box">
                    <h3>Ảnh hưởng</h3>
                    <p>Nghiêm trọng</p>
                    <div class="icons">
                        <i class="fa-solid fa-skull fa-2x"></i>
                        <i class="fa-solid fa-skull fa-2x"></i>
                        <i class="fa-solid fa-skull fa-2x"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>




    <!-- Nội dung chính -->

    <div class="container my-5">
        <div class="row">
            <div class="col-md-16">

                <div class="lesson-list p-4 shadow-sm bg-white rounded">

                    <div class="what">
                        <h2> <i class="fa-solid fa-magnifying-glass"></i>XML Bombs


                            là gì ?</h2>
                        <p>
                            XML Bombs là một kỹ thuật tấn công mà kẻ tấn công cố gắng tạo ra một tài liệu XML rất lớn
                            nhưng không nén được. Khi máy chủ cố gắng phân tích tài liệu XML này, nó sẽ tiêu tốn tất cả
                            tài nguyên của máy chủ và dẫn đến tình trạng quá tải. Điều này có thể dẫn đến tình trạng
                            máy chủ không phản hồi và dễ bị tấn công từ xa hoặc tấn công từ chối dịch vụ (DoS).
                        </p>
                        <p>
                            Cách để bảo vệ bản thân là đảm bảo quá trình phân tích cú pháp XML của ae được định cấu hình
                            đúng cách.

                        </p>

                    </div>

                    <br>

                    <div class="how">
                        <h2> <i class="fa-solid fa-shield-halved"></i>Cách để ngăn chặn XML Bombs

                        </h2>


                        <p><span class="red-bold">Disable Parsing of Inline DTDs (Tắt phân tích cú pháp DTD)</span></p>


                        <p>
                            DTD (Document Type Definition) là một phần của tài liệu XML mà định nghĩa cấu trúc của tài
                            liệu. Khi máy chủ phân tích tài liệu XML, nó sẽ phân tích cú pháp DTD để xác định cấu trúc
                            của tài liệu. Kẻ tấn công có thể sử dụng DTD để tạo ra một tài liệu XML rất lớn nhưng không
                            nén được. Để ngăn chặn kẻ tấn công sử dụng DTD để tạo ra XML Bombs, ae cần tắt phân tích cú
                            pháp DTD trên máy chủ của mình. Xem code mẫu bên dưới để biết cách tắt mặc định của DTD.
                        </p>

                        <p><span class="red-bold">Consider Making XML Parsing Asynchronous (Xem xét làm cho phân tích
                                XML
                                bất đồng bộ)</span></p>

                        <p>
                            Khi máy chủ phân tích tài liệu XML, quá trình này có thể tiêu tốn nhiều tài nguyên và thời
                            gian. Nếu kiến trúc của ae chưa có khả năng xử lý nhiều yêu cầu cùng lúc, kẻ tấn công có thể
                            tạo ra nhiều yêu cầu tới máy chủ của ae, mỗi yêu cầu chứa một XML Bomb. Để ngăn chặn tình
                            trạng quá tải máy chủ, ae cần xem xét làm cho quá trình phân tích XML trở nên bất đồng bộ.
                            Khi các tệp XML được tải lên, hãy chuyển chúng sang hàng đợi và có một quá trình riêng biệt
                            để phân tích chúng. Điều này giúp giảm thiểu tác động của XML Bombs tới máy chủ của ae.
                        </p>
                        <p>
                            Phương pháp này sẽ cải thiện khả năng mở rộng và tính ổn định của hệ thống ae, vì việc xử lý
                            các tác vụ lớn sẽ không ảnh hưởng nhiều đến máy chủ web của ae. (Các yêu cầu AJAX là một
                            ngoại lệ -
                            vì nó là một phần của Request-Response Cycle, phải được xử lí bởi máy chủ web)
                        </p>

                        <p><span class="red-bold">Throttle Uploads Per Client (Giảm tốc độ tải lên cho mỗi người
                                dùng)</span></p>
                        <p>
                            Hãy hạn chế số lượng tệp XML mà mỗi người dùng có thể tải lên trong một khoảng thời gian
                            nhất
                            định. Điều này giúp ngăn chặn kẻ tấn công sử dụng XML bomb, hoặc người dùng nào đó "vô tình"
                            tải lên một quả bom XML.

                        </p>

                        <p><span class="red-bold"> Code tham khảo </span></p>
                        <div class="div-1">
                            <span class="red-bold">Python</span>
                            <p>Sử dụng thư viện <span class="bold">defusedxml</span> để xử lí XML. </p>

                            <span class="red-bold">Ruby - Nokogiri</span>
                            <pre class="code-block">
doc = <span class="string">Nokogiri</span><span class="class-name">::XML</span>(<span class="string">File</span>.open(<span class="class-name">"data.xml"</span>)) <span class="keyword">do </span>|config|
    config.strict.noent
<span class="keyword">end</span> </pre>
                            
                            <span class="red-bold">Java</span>
                            <pre class="code-block">
<span class="string">DocumentBuilderFactory</span> <span class="class-name">dbf </span>= DocumentBuilderFactory.newInstance();
dbf.setExpandEntityReferences(<span class="string">false</span>);
                            </pre>

                          
                           
                        </div>


                    </div>



                    <br>

                    <div class="moreinfo">
                        <h2> <i class="fa-solid fa-info"></i> Thông tin thêm</h2>
                        <p>
                            Đây là một số bài viết hay ho mà mình thấy nên đọc thêm:
                        </p>
                        <ul class="styled-list">

                            <li><i class="fa-solid fa-link"></i><a
                                    href="https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing"
                                    target="_blank">OWASP - XML External Entity (XXE) Processing</a></li>
                            <li><i class="fa-solid fa-link"></i><a
                                    href="https://owasp.org/www-community/vulnerabilities/XML_Bomb"
                                    target="_blank">OWASP - XML Bomb</a></li>
                            <li><i class="fa-solid fa-link"></i><a
                                    href="https://portswigger.net/web-security/xml-bomb"
                                    target="_blank">PortSwigger - XML Bomb</a></li>
                                    
                        </ul>
                    </div>
                </div>
            </div>

        </div>
    </div>



    <footer class="bg-dark text-white text-center py-3">
        <script>

        </script>
        <p>&copy; Clone lại thằng Hacksplaining | <a href="https://github.com/Baodeptraii"
                class="text-white text-decoration-none">By Re3on</a></p>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css"></script>
    </footer>

    <!-- Thêm Bootstrap JS và Popper.js -->

</body>

</html>